# LU分解

## 历史背景
LU分解最早可以追溯到1938年，由德国数学家赫尔曼·多利特尔(Hermann Doolittle)提出。当时科学家们正在寻找一种高效的方法来求解大型线性方程组，特别是在工程计算和物理模拟中经常遇到的问题。

## 基本概念
### LU分解
最基本的LU分解是将一个矩阵分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积。对于一个方阵 $A$，如果存在一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 使得 $A = LU$，那么我们称 $A$ 可以进行LU分解。

### PLU分解
然而，在实际计算中，为了数值稳定性，我们通常使用PLU分解：
$PA = LU$

其中：
- $P$ 是置换矩阵（permutation matrix）
- $L$ 是单位下三角矩阵（unit lower triangular matrix）
- $U$ 是上三角矩阵（upper triangular matrix）

置换矩阵 $P$ 的作用是交换矩阵的行，这样可以避免在分解过程中出现零主元，提高计算的数值稳定性。

## 为什么需要PLU分解？
1. 数值稳定性：通过行交换避免除以很小的数
2. 避免零主元：确保分解过程可以继续进行
3. 保持计算精度：减少舍入误差的累积

当我们需要求解方程 $Ax = b$ 时，PLU分解的步骤是：
1. 先计算PLU分解：$PA = LU$
2. 令 $Pb = c$，问题转化为求解：$LUx = c$,  ($PAx=LUx=Pb=c$)
3. 依次求解：
   - $Ly = c$ （前向替换）
   - $Ux = y$ （后向替换）

## 前向替换和后向替换

### 前向替换 (Forward Substitution)
前向替换是求解下三角方程组 $Ly = c$ 的过程。之所以称为"前向"，是因为我们可以从第一个方程开始，依次向前求解每个未知数。

例如，对于方程组：
$$ \begin{bmatrix} 1 & 0 \\ l_{21} & 1 \end{bmatrix} \begin{bmatrix} y_1 \\ y_2 \end{bmatrix} = \begin{bmatrix} c_1 \\ c_2 \end{bmatrix} $$

1. 首先求解 $y_1$：
   $$ y_1 = c_1 $$
   
2. 然后利用 $y_1$ 求解 $y_2$：
   $$ l_{21}y_1 + y_2 = c_2 $$
   $$ y_2 = c_2 - l_{21}y_1 $$

这个过程之所以可行，是因为在求解每个 $y_i$ 时，所需的所有值都已经计算出来了。

### 后向替换 (Back Substitution)
后向替换是求解上三角方程组 $Ux = y$ 的过程。之所以称为"后向"，是因为我们需要从最后一个方程开始，反向求解每个未知数。

例如，对于方程组：
$$ \begin{bmatrix} u_{11} & u_{12} \\ 0 & u_{22} \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} = \begin{bmatrix} y_1 \\ y_2 \end{bmatrix} $$

1. 首先求解 $x_2$：
   $$ u_{22}x_2 = y_2 $$
   $$ x_2 = y_2/u_{22} $$
   
2. 然后利用 $x_2$ 求解 $x_1$：
   $$ u_{11}x_1 + u_{12}x_2 = y_1 $$
   $$ x_1 = (y_1 - u_{12}x_2)/u_{11} $$

这个过程之所以可行，是因为在求解每个 $x_i$ 时，所需的所有值都已经计算出来了。

### 为什么这样做更高效？
1. 三角方程组的求解非常简单和高效
2. 不需要进行消元操作
3. 计算量比直接求解原方程组少得多

例如，对于我们之前的例子：
$$ A = \begin{bmatrix} 2 & 3 \\ 5 & 4 \end{bmatrix} $$

求解 $Ax = b$ 时，我们先进行PLU分解：
$$ PA = LU $$

然后求解：
1. $Ly = Pb$ (前向替换)
2. $Ux = y$ (后向替换)

这样，即使对于不同的 $b$，我们也只需要进行一次PLU分解，然后重复使用简单的前向和后向替换过程。

## 实际例子
考虑矩阵 $A$：
$$ A = \begin{bmatrix} 2 & 3 \\ 5 & 4 \end{bmatrix} $$

其PLU分解为：
$$ P = \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}, \quad 
   L = \begin{bmatrix} 1 & 0 \\ 0.4 & 1 \end{bmatrix}, \quad 
   U = \begin{bmatrix} 5 & 4 \\ 0 & 1.4 \end{bmatrix} $$

验证：
$$ PA = LU $$

要得到原始矩阵，我们可以使用：
$$ A = P^TLU $$

## 优缺点分析
### 优点
1. 计算效率高：对于多次求解同一矩阵的情况
2. 存储效率好：可以将L和U存储在同一个矩阵中
3. 数值稳定性好：通过置换矩阵P保证

### 缺点
1. 实现相对复杂：需要考虑行交换
2. 对于稀疏矩阵，可能失去稀疏性
3. 并行化相对困难

## 应用场景
1. 求解线性方程组
   - 在有限元分析中求解大型方程组
   - 电路分析中的节点电压计算
   
2. 计算行列式
   - 行列式等于U矩阵对角线元素的乘积
   
3. 计算逆矩阵
   - 可以通过解n个线性方程组得到

## 替代技术
1. Cholesky分解
   - 仅适用于对称正定矩阵
   - 但计算量只有LU分解的一半
   
2. QR分解
   - 数值稳定性更好
   - 但计算量较大

## 高级应用
1. 预处理技术
   - 在迭代法求解大型稀疏线性方程组时
   - 使用不完全LU分解(ILU)作为预处理器

2. 区块三角化
   - 在处理大型稀疏矩阵时
   - 结合置换来获得更好的分解结构

## 扩展阅读
- 带选主元的LU分解
- 分块LU分解
- 并行LU分解算法
